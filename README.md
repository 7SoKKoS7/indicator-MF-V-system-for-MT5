# MasterForex-V MultiTF Indicator for MetaTrader 5

## –û–ø–∏—Å–∞–Ω–∏–µ

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä MasterForex-V MultiTF - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Å–∏—Å—Ç–µ–º—É MF-pivot –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- **–ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** (M5, M15, H1, H4, D1)
- **–°–∏—Å—Ç–µ–º–∞ MF-pivot** —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º ZigZag
- **–ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö** (M5, M15, H1)
- **–§–∏–ª—å—Ç—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π** (–õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫, –¢–æ–∫–∏–æ)
- **–°–∏—Å—Ç–µ–º–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞** (1-3 –±–∞–ª–ª–∞)
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
  - [–ù–æ–≤—ã–π v9] –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫—ç—à MF‚Äëpivot –º–µ–∂–¥—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è–º–∏ –¢–§ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)
  - [–ù–æ–≤–æ–µ] RETEST‚Äë–¥–≤–∏–∂–æ–∫ (M15/M5) —Å –±—É—Ñ–µ—Ä–∞–º–∏ –ø–æ ATR/NOISE, –º–µ—Ç–∫–∞–º–∏ OK/FAIL –∏ TTL
  - [–ù–æ–≤–æ–µ] –£—Å—Ç–æ–π—á–∏–≤–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ M15/M5 –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º –±–∞—Ä–∞–º (dual‚Äëpivot + ATR‚Äë—Ç–æ–ª–µ—Ä–∞–Ω—Å + fallback)
  - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω —Å–æ–≤–µ—Ç–Ω–∏–∫ (EA) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –¥–ª—è –∞–≤—Ç–æ—Ç–æ—Ä–≥–æ–≤–ª–∏

### –¢–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤:
- **üü° –°–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 3/3) - –∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üü¢ –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø–æ–∫—É–ø–∫–∏** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 1-2/3) - –∑–µ–ª–µ–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üî¥ –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–¥–∞–∂–∏** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 1-2/3) - –∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üîµ –†–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã** (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ) - –≥–æ–ª—É–±—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **‚ùå –°–∏–≥–Ω–∞–ª—ã –≤—ã—Ö–æ–¥–∞** (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ pivot) - —Å–µ—Ä—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏
- **üîÑ –°–∏–≥–Ω–∞–ª—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞** (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞) - –∞–∫–≤–∞ —Å—Ç—Ä–µ–ª–∫–∏

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –°–∏—Å—Ç–µ–º–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞:
- **3/3** - –æ—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ (–∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏)
- **2/3** - —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ (–∑–µ–ª–µ–Ω—ã–µ/–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏)
- **1/3** - —Å–ª–∞–±—ã–π —Ç—Ä–µ–Ω–¥ (—Ä–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã)

### –ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö:
- **M5** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **M15** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **H1** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –º–∏–Ω–∏–º—É–º 2 –∏–∑ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ –¥–æ–ª–∂–Ω—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±—ä–µ–º
- **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –±–∞—Ä—ã** –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞

### –§–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞:
- **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è** (–õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫, –¢–æ–∫–∏–æ)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
input bool   UseRussian = false;              // –ü–æ–¥–ø–∏—Å–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
input bool   ShowClassicPivot = true;         // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏ Pivot
input bool   ShowStatusInfo = true;           // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ
input bool   EnableVolumeFilter = true;       // –§–∏–ª—å—Ç—Ä –ø–æ –æ–±—ä–µ–º—É
input bool   EnableSessionFilter = true;      // –§–∏–ª—å—Ç—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
```

### –ü–∏–≤–æ—Ç—ã High/Low –∏ –¢–§:
```mql5
input bool   ShowPivotHighLow = true;         // –†–∏—Å–æ–≤–∞—Ç—å Pivot High/Low –Ω–∞ –≤—Å–µ—Ö –¢–§
input bool   UseTF_H4 = true;                 // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å H4 dual‚Äëpivot (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ)
input bool   UseTF_D1 = true;                 // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å D1 dual‚Äëpivot (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ZigZag:
```mql5
input int    InpDepth = 12;                   // –ì–ª—É–±–∏–Ω–∞ ZigZag
input double InpDeviation = 5.0;              // –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤ –ø—É–Ω–∫—Ç–∞—Ö
input double AtrDeviationK = 0.0;             // –ö–æ—ç—Ñ. ATR –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ (0=–≤—ã–∫–ª)
```
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –∫–∞–∂–¥—ã–π –¢–§ –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ —Å–≤–∏–Ω–≥–æ–≤ –Ω–∞ —Å—Ç–∞—Ä—à–∏—Ö –¢–§:
```mql5
input int    Depth_M5  = 12,  Depth_M15 = 12,  Depth_H1 = 12,  Depth_H4 = 12,  Depth_D1 = 12;
input double Dev_M5    = 5.0, Dev_M15   = 7.0, Dev_H1   = 12.0, Dev_H4   = 20.0, Dev_D1   = 30.0;
```

### RETEST (–±—É—Ñ–µ—Ä—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)
```mql5
// === Retest Settings ===
input int    ATR_Period         = 14;
input double NoisePips_Override = 0.0;  // 0 ‚Äî AUTO NOISE
input double BreakBuf_ATR_Frac  = 0.25;
input double RetestTol_ATR_Frac = 0.20;
input double BreakBuf_NoiseMul  = 1.0;
input double RetestTol_NoiseMul = 0.8;
input int    Retest_MaxBars     = 3;
input int    Label_TTL_Bars     = 6;
input bool   NewsMode           = false;
input double NewsMode_Mul       = 2.5;
```
–õ–æ–≥–∏–∫–∞: –ø—Ä–æ–±–æ–π —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–º –±–∞—Ä–µ TF (`Close[1]`), —Ä–µ—Ç–µ—Å—Ç –∏—â–µ—Ç—Å—è –≤ –æ–∫–Ω–µ `k<=Retest_MaxBars`, –º–µ—Ç–∫–∏ `RETEST OK/FAIL`, –ª–∏–Ω–∏—è pivot –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è (WAIT/OK/FAIL), –Ω–æ–≤–æ—Å—Ç–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç –±—É—Ñ–µ—Ä—ã (NEWS xK –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –ø–∞–Ω–µ–ª–∏).

### –†–∞–∑–º–µ—Ä—ã/—Ü–≤–µ—Ç–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–æ–∫:
```mql5
// –¶–≤–µ—Ç–∞ —Å—Ç—Ä–µ–ª–æ–∫
input color  BuyArrowColor = clrLime;
input color  SellArrowColor = clrRed;
input color  EarlyBuyColor = clrDodgerBlue;
input color  EarlySellColor = clrDeepSkyBlue;
input color  ExitColor = clrGray;
input color  ReverseColor = clrAqua;
input color  StrongSignalColor = clrYellow;
input color  EarlyExitColor = clrSandyBrown;

// –†–∞–∑–º–µ—Ä—ã
input int    ArrowWidth = 2;                  // –¢–æ–ª—â–∏–Ω–∞ —Å—Ç—Ä–µ–ª–æ–∫
input int    ArrowOffset = 10;                // –°–º–µ—â–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–æ–∫ –≤ –ø—É–Ω–∫—Ç–∞—Ö

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã)
input bool   ShowStrongSignals  = true;       // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–µ (–∂—ë–ª—Ç—ã–µ) –≤—Ö–æ–¥—ã
input bool   ShowNormalSignals  = true;       // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ –≤—Ö–æ–¥—ã
input bool   ShowEarlySignals   = true;       // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞–Ω–Ω–∏–µ –≤—Ö–æ–¥—ã
input bool   ShowExitSignals    = true;       // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—ã—Ö–æ–¥—ã/—Ä–∞–Ω–Ω–∏–µ –≤—ã—Ö–æ–¥—ã
input bool   ShowReversalSignals= true;       // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã
 input bool   ShowHistorySignals = true;       // –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏
 input int    SignalsLookbackBars= 500;        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –∏—Å—Ç–æ—Ä–∏–∏
input int    MinBarsBetweenArrows = 6;        // –ú–∏–Ω–∏–º—É–º –±–∞—Ä–æ–≤ –º–µ–∂–¥—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ —Å—Ç—Ä–µ–ª–∫–∞–º–∏
```

### –¶–≤–µ—Ç–∞ Pivot High/Low:
```mql5
input color  PivotHighColor = clrRed;         // –¶–≤–µ—Ç Pivot High (—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ)
input color  PivotLowColor  = clrLime;        // –¶–≤–µ—Ç Pivot Low  (–ø–æ–¥–¥–µ—Ä–∂–∫–∞)
```

### Dual‚Äëpivot MF‚Äëpivots (High/Low)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¢–§ (H1, M15, M5; –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ H4, D1) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–≤–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω—è: `PivotHigh_TF` –∏ `PivotLow_TF` –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ ZigZag.
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –±–∞—Ä–∞—Ö: —Ç–µ–∫—É—â–∏–π –±–∞—Ä –∏—Å–∫–ª—é—á—ë–Ω. –ù–∏–∫–∞–∫–æ–≥–æ —Ä–µ–ø–µ–π–Ω—Ç–∞.
- –ü–æ—Ä–æ–≥ ZigZag –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è: `max(Dev_TF*_Point, AtrDeviationK*ATR(tf,14))` –ø—Ä–∏ `AtrDeviationK>0`. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–µ `Depth_*`/`Dev_*` –ø–æ –¢–§.
- –ö—ç—à –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–µ High/Low, –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –Ω–µ –∑–∞—Ç–∏—Ä–∞–µ—Ç—Å—è –Ω—É–ª—è–º–∏.

#### –¢—Ä–µ–Ω–¥ –æ—Ç dual‚Äëpivot
- Up: –µ—Å–ª–∏ `Close_TF[1] > PivotLow_TF` –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π swing = Up.
- Down: –µ—Å–ª–∏ `Close_TF[1] < PivotHigh_TF` –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π swing = Down.
- –ò–Ω–∞—á–µ ‚Äî Flat (–º–µ–∂–¥—É H/L –∏–ª–∏ –±–ª–∏–∂–µ, —á–µ–º —Ç–æ–ª–µ—Ä–∞–Ω—Å `max(2*_Point, 0.1*ATR(H1))`).

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Å—Å–∏–π:
```mql5
input int    SessionGMTOffset = 2;            // –°–º–µ—â–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ GMT (–ø—Ä–∏–º–µ—Ä: 2 –¥–ª—è GMT+2)
```
- –û–ø—Ü–∏—è `UseDST = true` ‚Äî –∞–≤—Ç–æ‚Äë–ø–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –ª–µ—Ç–Ω–µ–µ –≤—Ä–µ–º—è (–ï–≤—Ä–æ–ø–∞: —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –º–∞—Ä—Ç–∞ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –æ–∫—Ç—è–±—Ä—è).
- –û–∫–Ω–∞ —Å–µ—Å—Å–∏–π –∑–∞–¥–∞–Ω—ã –≤ GMT: –õ–æ–Ω–¥–æ–Ω 8‚Äì16, –ù—å—é‚Äë–ô–æ—Ä–∫ 13‚Äì21, –¢–æ–∫–∏–æ 0‚Äì8.
- –í—Ä–µ–º—è –±–µ—Ä—ë—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –±—Ä–æ–∫–µ—Ä–∞ (`TimeTradeServer()`), –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ GMT –∫–∞–∫ `hourGMT = hourServer - (SessionGMTOffset + (UseDST?1:0) –≤ –ª–µ—Ç–Ω–∏–π –ø–µ—Ä–∏–æ–¥)`.
- –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ–¥ DST –Ω–µ—Ç ‚Äî `SessionGMTOffset` –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—Ä—É—á–Ω—É—é (—á–∞—Å—Ç–æ 2 –∑–∏–º–æ–π, 3 –ª–µ—Ç–æ–º).
- –ü—Ä–∏–º–µ—Ä: Market Watch 22:40, –ª–æ–∫–∞–ª—å–Ω–æ –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã 21:40 (UTC+2) ‚Üí —Å–µ—Ä–≤–µ—Ä ~UTC+3 ‚Üí `SessionGMTOffset = 3`.

### –§–∏–ª—å—Ç—Ä—ã MasterForex-V:
```mql5
input double MinVolumeMultiplier = 1.2;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –æ–±—ä–µ–º–∞
input int    MinTrendStrength = 2;            // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ (1-3)
input int    MinEarlyTrendStrength = 1;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è —Ä–∞–Ω–Ω–∏—Ö –≤—Ö–æ–¥–æ–≤ (1-3)
// –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –±—É–¥—É—â–µ–µ EA (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä):
input bool   UseRiskManagement = true;
input double MaxRiskPercent = 2.0;
```

### Clinch (—Å—Ö–≤–∞—Ç–∫–∞) –≤–æ–∫—Ä—É–≥ dual‚Äëpivot H1
```mql5
input bool   UseClinchFilter   = true;        // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä ¬´—Å—Ö–≤–∞—Ç–∫–∏¬ª
input double ClinchAtrK        = 0.50;        // –ü–æ–ª—É—à–∏—Ä–∏–Ω–∞ –∑–æ–Ω—ã: k * ATR(H1)
input int    ClinchLookbackH1  = 24;          // –°–∫–æ–ª—å–∫–æ H1-–±–∞—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
input int    ClinchFlipsMin    = 3;           // –ú–∏–Ω–∏–º—É–º –ø–µ—Ä–µ–±—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ pivotH1
input double ClinchRangeMaxATR = 1.20;        // –ú–∞–∫—Å. –¥–∏–∞–ø–∞–∑–æ–Ω –∑–∞ Lookback –≤ ATR(H1)
input bool   ShowClinchZoneOnlyIfTouched = true; // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–æ–Ω—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ü–µ–Ω–∞ –∑–∞—Ö–æ–¥–∏–ª–∞ –≤ –Ω–µ—ë –∑–∞ Lookback
```
- –ó–æ–Ω–∞ clinch ‚Äî –∫–æ—Ä–∏–¥–æ—Ä –º–µ–∂–¥—É `PivotLow_H1` –∏ `PivotHigh_H1` (–≤–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫). –î–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–±—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –∫–æ—Ä–∏–¥–æ—Ä–∞.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω —Ä–µ–∂–∏–º `Clinch_ATR_Midline`: `mid=(H+L)/2`, `zone=mid¬±ClinchAtrK*ATR(H1)`.
- –ü—Ä–∏–∑–Ω–∞–∫ clinch: —á–∞—Å—Ç—ã–µ –ø–µ—Ä–µ–±—Ä–æ—Å—ã —Ü–µ–Ω—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä–∏–¥–æ—Ä–∞ (–ø–æ Close H1) –∏ —Å–∂–∞—Ç—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: `max(high)‚àímin(low)` –∑–∞ `ClinchLookbackH1` ‚â§ `ClinchRangeMaxATR * ATR(H1)`.
- –í clinch –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –∫–ª–∞—Å—Å —Å–∏–≥–Ω–∞–ª–æ–≤: —Å–∏–ª—å–Ω—ã–µ ‚Üí –æ–±—ã—á–Ω—ã–µ, –æ–±—ã—á–Ω—ã–µ ‚Üí —Ä–∞–Ω–Ω–∏–µ, —Ä–∞–Ω–Ω–∏–µ ‚Üí –±–ª–æ–∫.
- –í –ø–∞–Ω–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞: `Clinch: ‚úì/‚úó, flips=X, range=Y ATR, band=H/L` –∏–ª–∏ `zone=¬±K ATR` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞.
> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ Risk Management: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `UseRiskManagement` –∏ `MaxRiskPercent` –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Å–æ–≤–µ—Ç–Ω–∏–∫–∞ (EA). –í —Ç–µ–∫—É—â–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ –æ–Ω–∏ –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞—Å—á—ë—Ç —Å–∏–≥–Ω–∞–ª–æ–≤.

### –°—Ç—Ä–æ–≥–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ ¬´no repaint¬ª –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –±–∞—Ä–∞—Ö; –≤ –ª–æ–≥–∏–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ü–µ–Ω–∞ `Close[1]` —Ç–µ–∫—É—â–µ–≥–æ –¢–§.
- –¢—Ä–µ–Ω–¥‚Äë—Ç–æ–ª–µ—Ä–∞–Ω—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç ZigZag: `tol = max(2*_Point, TrendTolAtrK*ATR(H1))`.
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è H1: –¥–ª—è –ø–æ–∫—É–ø–æ–∫ ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `PivotHigh_H1`, –¥–ª—è –ø—Ä–æ–¥–∞–∂ ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `PivotLow_H1`; —Ä–µ—Ç–µ—Å—Ç –∏—â–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ü–û–°–õ–ï –∑–∞–∫—Ä—ã—Ç–∏—è —á–∞—Å–∞ (`fromTime = iTime(H1,1) + PeriodSeconds(H1)`).
- Clinch —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º H1‚Äë–±–∞—Ä–∞–º; –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∑–æ–Ω–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è —Å —Ç–µ–º –∂–µ ATR, —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è–ª—Å—è –ø—Ä–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–∑–∞–º–æ—Ä–æ–∑–∫–∞ ATR).
- –í—ã—Ö–æ–¥—ã (–≤–∫–ª—é—á–∞—è Soft/Hard) —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç—É—é —Ü–µ–Ω—É –±–∞—Ä–∞; –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ `Close[0]`.
- –í —Ä–µ–∂–∏–º–µ `Exit_Nearest` ¬´–±–ª–∏–∂–∞–π—à–∏–π¬ª pivot –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ü–µ–Ω—ã –Ω–∞ –±–∞—Ä–µ –≤—Ö–æ–¥–∞, –∞ –Ω–µ —Ç–µ–∫—É—â–µ–π.

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è Pivot (H1)
```mql5
enum ConfirmMode { Confirm_Off, Confirm_StrongOnly, Confirm_StrongAndNormal, Confirm_All };
input ConfirmMode BreakoutConfirm = Confirm_StrongOnly; // –†–µ–∂–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

input int    H1ClosesNeeded       = 2;     // —Å–∫–æ–ª—å–∫–æ H1‚Äë–∑–∞–∫—Ä—ã—Ç–∏–π –∑–∞ pivot
input int    RetestWindowM15      = 12;    // –æ–∫–Ω–æ —Ä–µ—Ç–µ—Å—Ç–∞ –≤ M15‚Äë–±–∞—Ä–∞—Ö (–¥–æ 3 —á)
input double RetestTolATR_M15     = 0.25;  // –¥–æ–ø—É—Å–∫ –∫–∞—Å–∞–Ω–∏—è: ¬±0.25*ATR(M15)
input double WickRejectMin        = 0.60;  // –¥–æ–ª—è —Ç–µ–Ω–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –±–∞—Ä–∞ (–æ—Ç—Å–∫–æ–∫)
input bool   UseRetestVolume      = true;  // —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±—ä—ë–º –Ω–∞ —Ä–µ—Ç–µ—Å—Ç–µ
input double RetestVolMult        = 1.20;  // –æ–±—ä—ë–º —Ä–µ—Ç–µ—Å—Ç–∞ > 1.2√ó —Å—Ä–µ–¥–Ω–µ–≥–æ
input bool   RetestAllowM5        = true;  // —Ä–µ—Ç–µ—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –Ω–∞ M5
input int    RetestWindowM5       = 36;    // –æ–∫–Ω–æ —Ä–µ—Ç–µ—Å—Ç–∞ –≤ M5‚Äë–±–∞—Ä–∞—Ö (~3 —á)
input double RetestTolATR_M5      = 0.35;  // –¥–æ–ø—É—Å–∫ –∫–∞—Å–∞–Ω–∏—è –¥–ª—è M5
```
- Strong –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç—Ä–µ–±—É–µ—Ç: 2 –∑–∞–∫—Ä—ã—Ç–∏—è H1 –∑–∞ pivot –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤—Ö–æ–¥–∞ –ò —Ä–µ—Ç–µ—Å—Ç —É—Ä–æ–≤–Ω—è –Ω–∞ M15 (–ø–æ –∂–µ–ª–∞–Ω–∏—é —Ç–∞–∫–∂–µ M5) —Å –æ—Ç—Å–∫–æ–∫–æ–º (—Ç–µ–Ω—å) –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –æ–±—ä—ë–º–æ–º.
- Normal: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 1 –∑–∞–∫—Ä—ã—Ç–∏—è H1 –∑–∞ pivot; –µ—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–µ—Ç ‚Äî —Å–∏–≥–Ω–∞–ª –±—É–¥–µ—Ç –ø–æ–Ω–∏–∂–µ–Ω –¥–æ Early.
- Early: –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π.
- –†–µ–∂–∏–º –∑–∞–¥–∞—ë—Ç—Å—è `BreakoutConfirm`: –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ —Ç–æ–ª—å–∫–æ –∫ Strong (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), –∫ Strong+Normal, –∫–æ –≤—Å–µ–º –∏–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å.
- –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π ¬´—Å—Ö–≤–∞—Ç–∫–µ¬ª (clinch) –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –∫–ª–∞—Å—Å —É–∂–µ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–æ–º clinch.

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

 - **–¢—Ä–µ–Ω–¥ H1: ‚Üë M15: ‚Üë M5: ‚Üë** - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤
 - **Pivot H1: H=1.23456 | L=1.22345**
 - **Pivot M15: H=... | L=...**
 - **Pivot M5: H=... | L=...**
- **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞: 3/3** - –æ—Ü–µ–Ω–∫–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ (1-3 –±–∞–ª–ª–∞)
- **–û–±—ä–µ–º M5:‚úì M15:‚úì H1:‚úì (3/3)** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
- **–°–µ—Å—Å–∏—è: ‚úì** - –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
- **RT: OK|WAIT|FAIL | buf=XX pips | tol=YY pips** ‚Äî —Å—Ç–∞—Ç—É—Å —Ä–µ—Ç–µ—Å—Ç–∞ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –±—É—Ñ–µ—Ä—ã

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö):
 - **Clinch:** `‚úì/‚úó, flips=X, range=Y ATR, band=H/L` ‚Äî —Å—Ç–∞—Ç—É—Å ¬´—Å—Ö–≤–∞—Ç–∫–∏¬ª –≤ –∫–æ—Ä–∏–¥–æ—Ä–µ `PivotLow_H1..PivotHigh_H1` (–ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º –±–∞—Ä–∞–º H1).
- **–§–∞–∑–∞:** `Trend/Flat` ‚Äî –¥–µ—Ç–µ–∫—Ç–æ—Ä —Ä—ã–Ω–æ—á–Ω–æ–π —Ñ–∞–∑—ã –ø–æ –∫–∞—á–µ–ª—è–º –Ω–∞ M15; –≤–æ —Ñ–ª–µ—Ç–µ —Å–∏–≥–Ω–∞–ª—ã –¥–∞—É–Ω–≥—Ä–µ–π–¥—è—Ç—Å—è –¥–æ Early.
- **Consensus:** `2/3 ‚úì | EMA:‚Üë|‚Üì|‚Äì | RSI: ‚úì|‚úó` ‚Äî –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ MF‚Äë—è–¥—Ä–æ/EMA/RSI. –†–µ–∂–∏–º —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `Consensus` (PanelOnly/Gate*/BlockAll).
- **–°–∏–≥–Ω–∞–ª:** `Strong BUY/Strong SELL/BUY/SELL/Early BUY/Early SELL/Early EXIT/HARD EXIT/Reversal` ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏–≥–Ω–∞–ª–∞.

## –õ–æ–≥–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### –°–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚úÖ **–í—Å–µ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç** (H1, M15, M5)
- ‚úÖ **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ = 3/3** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**
 - ‚úÖ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ `BreakoutConfirm`) **–ü—Ä–æ–±–æ–π —Å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º**: `H1ClosesNeeded` –∑–∞–∫—Ä—ã—Ç–∏–π –∑–∞ pivot + **—Ä–µ—Ç–µ—Å—Ç** pivot –Ω–∞ M15/M5 —Å –æ—Ç—Å–∫–æ–∫–æ–º (—Ç–µ–Ω—å—é) –∏, –ø—Ä–∏ `UseRetestVolume=true`, –æ–±—ä—ë–º–æ–º ‚â• `RetestVolMult`√ó—Å—Ä–µ–¥–Ω–µ–≥–æ.

### –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–∑–µ–ª–µ–Ω—ã–µ/–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚úÖ **–í—Å–µ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç** (H1, M15, M5)
- ‚ö†Ô∏è **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ = 1-2/3** (—Å—Ä–µ–¥–Ω—è—è)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**
 - ‚ö†Ô∏è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ Normal) –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–æ–±–æ—è –ø–æ H1 ‚Äî —Å–∏–≥–Ω–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ Early.

### –†–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã (–≥–æ–ª—É–±—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ** (H1 –∏ M5, –Ω–æ –ù–ï M15)
- ‚ö†Ô∏è **–°–ª–∞–±–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞** ‚Äî –ø–æ—Ä–æ–≥ –∑–∞–¥–∞—ë—Ç—Å—è `MinEarlyTrendStrength` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1/3)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**

### –ò–º–ø—É–ª—å—Å‚Äë–æ—Ç–∫–∞—Ç (MF A‚ÄëB‚ÄëC) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è/–ø–æ–Ω–∏–∂–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞
- –ù–∞ M15, –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–¥–∞ H1, —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ A‚ÄëB‚ÄëC:
  - –ò–º–ø—É–ª—å—Å ¬´–∑–¥–æ—Ä–æ–≤—ã–π¬ª, –µ—Å–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ `|B‚àíA| / |C‚àíB| ‚â• ImpulseMinRatio` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.5).
  - –ì–ª—É–±–∏–Ω–∞ –æ—Ç–∫–∞—Ç–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –¥–æ–ª—è `|C‚àíB| / |B‚àíA|` –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å `PullbackMaxFib` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.618).
- –ü—Ä–∞–≤–∏–ª–∞ –∞–ø/–¥–∞—É–Ω‚Äë–≥—Ä–µ–π–¥–∞:
  - –ï—Å–ª–∏ –∏–º–ø—É–ª—å—Å ¬´–∑–¥–æ—Ä–æ–≤—ã–π¬ª ‚Äî —Ä–∞–Ω–Ω–∏–π —Å–∏–≥–Ω–∞–ª (Early) –∞–ø–≥—Ä–µ–π–¥–∏—Ç—Å—è –¥–æ –æ–±—ã—á–Ω–æ–≥–æ (Normal).
  - –ï—Å–ª–∏ –æ—Ç–∫–∞—Ç —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–∏–π ‚Äî –æ–±—ã—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª (Normal) –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ —Ä–∞–Ω–Ω–µ–≥–æ (Early) –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é, —Å–µ–π—á–∞—Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ).

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
input bool   UseImpulseFilter     = true;   // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å–∞/–æ—Ç–∫–∞—Ç–∞
input double ImpulseMinRatio      = 1.5;    // |B‚àíA| / |C‚àíB| –º–∏–Ω–∏–º—É–º
input double PullbackMaxFib       = 0.618;  // –º–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ –æ—Ç–∫–∞—Ç–∞ (–¥–æ–ª—è –∏–º–ø—É–ª—å—Å–∞)
input int    ImpulseBackWindowM15 = 48;     // –ø–æ–∏—Å–∫ A –ø–µ—Ä–µ–¥ B (M15‚Äë–±–∞—Ä–æ–≤)
input int    PullbackWindowM15    = 12;     // –ø–æ–∏—Å–∫ C –ø–æ—Å–ª–µ B (M15‚Äë–±–∞—Ä–æ–≤)
```

### –§–∏–ª—å—Ç—Ä ¬´—Ä—ã–Ω–æ—á–Ω–æ–π —Ñ–∞–∑—ã¬ª (Flat/Trend)
–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–∞—É–Ω–≥—Ä–µ–π–¥–∏—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–æ Early –≤–æ —Ñ–ª–µ—Ç–µ, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–Ω–æ–Ω—É MF‚ÄëV (—Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç—Ä–µ–Ω–¥–µ).
- –î–µ—Ç–µ–∫—Ü–∏—è: –ø–æ —Ç—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–º –∫–∞—á–µ–ª—è–º –Ω–∞ M15. –í—ã—á–∏—Å–ª—è–µ–º –¥–ª–∏–Ω—ã —Ç—Ä—ë—Ö –∫–æ–ª–µ–Ω, —Å—á–∏—Ç–∞–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ –±–µ—Ä—ë–º –º–µ–¥–∏–∞–Ω—É.
- –ï—Å–ª–∏ –º–µ–¥–∏–∞–Ω–∞ < `FlatMedianThreshold` (–¥–µ—Ñ–æ–ª—Ç 1.20) ‚Äî —Ñ–ª–µ—Ç: —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–∞–Ω–Ω–∏–µ –≤—Ö–æ–¥—ã. –ü–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É `Phase: Flat/Trend`.
```mql5
input bool   UseMarketPhaseFilter = true;   // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —Ñ–ª–µ—Ç/—Ç—Ä–µ–Ω–¥
input double FlatMedianThreshold  = 1.20;   // –ü–æ—Ä–æ–≥ –º–µ–¥–∏–∞–Ω—ã —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π –∫–∞—á–µ–ª–µ–π (–Ω–∏–∂–µ ‚Äî —Ñ–ª–µ—Ç)
```

### –°–∏–≥–Ω–∞–ª—ã –≤—ã—Ö–æ–¥–∞ (—Å–µ—Ä—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏):
- ‚ùå **–ñ—ë—Å—Ç–∫–∏–π –≤—ã—Ö–æ–¥ (hard):** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –¥–ª—è Long –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–∏–∂–µ `PivotLow_H1`, –¥–ª—è Short ‚Äî –≤—ã—à–µ `PivotHigh_H1`.
- ‚ÑπÔ∏è –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç–∫—É —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (–∞–∫–≤–∞), –∫–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –Ω–∞ H1 –∏ M15.

### –†–µ–∂–∏–º—ã –≤—ã—Ö–æ–¥–∞ (ExitMode)
```mql5
enum ExitMode { Exit_H1, Exit_EntryTF, Exit_Nearest, Exit_SoftHard };
input ExitMode ExitLogic = Exit_H1;           // –¥–µ—Ñ–æ–ª—Ç: H1
input double   ExitNearestAtrK = 0.25;        // —Ñ–∏–ª—å—Ç—Ä –±–ª–∏–∑–æ—Å—Ç–∏ (–≤ ATR M15) –¥–ª—è Nearest
```
- **Exit_H1 (–¥–µ—Ñ–æ–ª—Ç)**: Long ‚Äî –ø–æ `PivotLow_H1`, Short ‚Äî –ø–æ `PivotHigh_H1`.
- **Exit_EntryTF**: Long ‚Äî –ø–æ `PivotLow_M5`, Short ‚Äî –ø–æ `PivotHigh_M5`.
- **Exit_Nearest**: –±–ª–∏–∂–∞–π—à–∏–π –∏–∑ `Pivot*_M5/M15/H1` –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º `ExitNearestAtrK * ATR(M15)`.
- **Exit_SoftHard**: Soft ‚Äî Long –ø–æ `PivotLow_M15`, Short –ø–æ `PivotHigh_M15`; Hard ‚Äî Long –ø–æ `PivotLow_H1`, Short –ø–æ `PivotHigh_H1`.

### –ö–æ–Ω—Å–µ–Ω—Å—É—Å‚Äë—Ñ–∏–ª—å—Ç—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ò–¥–µ—è: —É –≤–∞—Å —Ç—Ä–∏ ¬´–≥–æ–ª–æ—Å–∞¬ª ‚Äî MF‚Äë—è–¥—Ä–æ, EMA‚Äë–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ M15, RSI(14) M15. –ö–æ–Ω—Å–µ–Ω—Å—É—Å ¬´2 –∏–∑ 3¬ª –º–æ–∂–µ—Ç:
- —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –Ω–∞ –ø–∞–Ω–µ–ª–∏,
- –¥–∞—É–Ω–≥—Ä–µ–π–¥–∏—Ç—å Strong (–∏–ª–∏ Strong/Normal),
- –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—ã –±–µ–∑ 2/3.

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
enum ConsensusMode { Cons_Off, Cons_PanelOnly, Cons_GateStrong, Cons_GateStrongNormal, Cons_BlockAll };
input ConsensusMode  Consensus   = Cons_PanelOnly;
input int   EmaFast = 50, EmaSlow = 200;
input double EmaSlopeMin = 0.0;   // –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–∫–ª–æ–Ω EMA50
input int   RsiPeriod = 14;
input int   RsiOB = 70, RsiOS = 30;
input int   RsiHyst = 5;          // –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å
```
- EMA‚Äë–≥–æ–ª–æ—Å: `EMA50 > EMA200` (–∏ |–Ω–∞–∫–ª–æ–Ω| EMA50 ‚â• `EmaSlopeMin * ATR(M15)`; –ø—Ä–∏ `EmaSlopeMin=0` –Ω–∞–∫–ª–æ–Ω –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è) ‚Üí buy; `<` ‚Üí sell; –∏–Ω–∞—á–µ ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ.
- RSI‚Äë–≥–æ–ª–æ—Å: buy —Ä–∞–∑—Ä–µ—à—ë–Ω, –µ—Å–ª–∏ `RSI ‚â§ (OB-Hyst)`; sell ‚Äî –µ—Å–ª–∏ `RSI ‚â• (OS+Hyst)`.
- –†–µ–∂–∏–º—ã:
  - Off ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç.
  - PanelOnly ‚Äî —Ä–∏—Å—É–µ—Ç —Å—Ç—Ä–æ–∫—É `Consensus: 2/3 ‚úì | EMA:‚Üë | RSI:‚úì`.
  - GateStrong ‚Äî –±–µ–∑ 2/3 Strong ‚Üí Normal.
  - GateStrongNormal ‚Äî –±–µ–∑ 2/3: Strong ‚Üí Normal, Normal ‚Üí Early.
  - BlockAll ‚Äî –±–µ–∑ 2/3 –≤—Ö–æ–¥—ã –Ω–µ —Ä–∏—Å—É—é—Ç—Å—è.

–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: Clinch –ø–æ–Ω–∏–∂–∞–µ—Ç –∫–ª–∞—Å—Å ‚Üí Consensus (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω) –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç. Early –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å ¬´—Ä–∞–Ω–Ω–∏–π¬ª —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤.

 –ü–∞–Ω–µ–ª—å:
 - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏ `Phase: Flat/Trend` –∏ –µ–¥–∏–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ Consensus:
   `Consensus: {votes}/3 {‚úì|‚úó} | [H1: {‚Üë|‚Üì|‚Äì} {‚úì|‚Äì} | EMA(M15): {‚Üë|‚Üì|‚Äì} {‚úì|‚úó|‚Äì} | RSI(M15): {‚úì|‚úó|‚Äì}]`
   –ù–∞–∫–ª–æ–Ω EMA —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ ¬´–ø—É–Ω–∫—Ç—ã —Ü–µ–Ω—ã/–±–∞—Ä¬ª: `slopeThresh = EmaSlopeMin * _Point`.
### –°–∏–≥–Ω–∞–ª—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (–∞–∫–≤–∞ —Å—Ç—Ä–µ–ª–∫–∏):
- üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞** –Ω–∞ H1 –∏ M15
- üîÑ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç** —Ç—Ä–µ–Ω–¥–∞

#### –û —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã—Ö–æ–¥–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–ª–µ–¥—É–µ—Ç —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ–π –ª–æ–≥–∏–∫–µ MF‚ÄëV: –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—ë—Ç H1, –≤—Ö–æ–¥—ã ‚Äî –Ω–∞ M5/M15, –≤—ã—Ö–æ–¥ ‚Äî –ø–æ pivotH1. –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —à—É–º –∏ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Ö–≤–∞—Ç—ã.
- –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –æ–ø—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º):
  - ¬´–ü–æ –¢–§ –≤—Ö–æ–¥–∞¬ª (—á–∞—â–µ M5): –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ç–æ–ø –∏ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏.
  - ¬´–ë–ª–∏–∂–∞–π—à–∏–π pivot (M5/M15/H1)¬ª —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ ATR, —á—Ç–æ–±—ã –Ω–µ –±—Ä–∞—Ç—å —Å–ª–∏—à–∫–æ–º —Ç–µ—Å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏.
  - ¬´–î–≤–∞ —É—Ä–æ–≤–Ω—è: –º—è–≥–∫–∏–π/–∂—ë—Å—Ç–∫–∏–π¬ª: soft ‚Äî –ø–æ M15 (—á–∞—Å—Ç–∏—á–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è/BE), hard ‚Äî –ø–æ H1 (–ø–æ–ª–Ω—ã–π –≤—ã—Ö–æ–¥).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `MasterForex_V.mq5` –≤ –ø–∞–ø–∫—É `MQL5/Indicators/`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ MetaTrader 5
3. –ù–∞–π–¥–∏—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ —Å–ø–∏—Å–∫–µ –∫–∞–∫ "MasterForex-V MultiTF v9.0"
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Å–≤–æ–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è

### –°–æ–≤–µ—Ç–Ω–∏–∫ (EA) –¥–ª—è –∞–≤—Ç–æ—Ç–æ—Ä–≥–æ–≤–ª–∏

–î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–π–ª `MasterForex_V_EA_v82308.mq5` ‚Äî —Å–æ–≤–µ—Ç–Ω–∏–∫, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–∏–≥–Ω–∞–ª—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞:
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç `MasterForex_Pivot_my_v82308.ex5` —á–µ—Ä–µ–∑ `iCustom` –∏ —á–∏—Ç–∞–µ—Ç –±—É—Ñ–µ—Ä—ã —Å—Ç—Ä–µ–ª–æ–∫ (Early/Normal/Strong) –∏ –≤—ã—Ö–æ–¥–æ–≤.
- –ü—Ä–∞–≤–∏–ª–∞ –ª–æ—Ç–∞: —Ä–∞–Ω–Ω–∏–µ –≤—Ö–æ–¥—ã ‚Äî –ø–æ–ª–æ–≤–∏–Ω–Ω—ã–π –ª–æ—Ç, –æ–±—ã—á–Ω—ã–µ ‚Äî 0.75√ó, —Å–∏–ª—å–Ω—ã–µ ‚Äî –ø–æ–ª–Ω—ã–π –ª–æ—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è).
- –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ –≤—ã—Ö–æ–¥–∞ (–∫—Ä–µ—Å—Ç–∏–∫) –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é.
- –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º –±–∞—Ä–∞–º —Ç–µ–∫—É—â–µ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞.

#### –ê–≤—Ç–æ‚ÄëSL/TP –ø–æ –º–µ—Ç–æ–¥–∏–∫–µ MasterForex‚ÄëV
- –í–∫–ª—é—á–∞–µ—Ç—Å—è –æ–ø—Ü–∏–µ–π `UseAutoSLTP` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ).
- SL —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–≥–æ pivot: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é H1, –∞ –¥–ª—è —Ä–∞–Ω–Ω–∏—Ö –≤—Ö–æ–¥–æ–≤ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ M15 (`UseM15PivotForEarly`).
- –§–æ—Ä–º—É–ª–∞ SL: SL = pivot ¬± (SL_AtrK_H1 √ó ATR(H1) + SL_ExtraPoints√ó_Point), –≤ —Å—Ç–æ—Ä–æ–Ω—É, –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å–¥–µ–ª–∫–µ.
- –†–µ–∂–∏–º—ã TP (`TakeProfitMode`):
  - `TP_RiskReward` ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∏—Å–∫/–ø—Ä–∏–±—ã–ª—å `TP_RR` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1:2).
  - `TP_PivotHigher` ‚Äî —Ü–µ–ª—å = –±–ª–∏–∂–∞–π—à–∏–π pivot —Å—Ç–∞—Ä—à–µ–≥–æ –¢–§ (H4 –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ, –∑–∞—Ç–µ–º H1) –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–¥–µ–ª–∫–∏.
- –°–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ: –æ–ø—Ü–∏—è `TrailByM15Pivot` –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç SL –∑–∞ pivot M15 –ø–æ –º–µ—Ä–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã EA:
```mql5
input bool     UseAutoSLTP        = true;
input bool     UseM15PivotForEarly= false;
input double   SL_AtrK_H1         = 0.10;   // –¥–æ–±–∞–≤–∫–∞ –∫ SL: k*ATR(H1)
input int      SL_ExtraPoints     = 3;      // –∑–∞–ø–∞—Å –∫ SL (–ø—É–Ω–∫—Ç—ã 4-–∑–Ω–∞–∫)
enum TPMode { TP_None, TP_RiskReward, TP_PivotHigher };
input TPMode   TakeProfitMode     = TP_RiskReward;
input double   TP_RR              = 2.0;
input bool     TrailByM15Pivot    = true;
```

–ó–∞–º–µ—á–∞–Ω–∏–µ: EA –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ª–æ–≥–∏–∫—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç—ã–µ –±–∞—Ä—ã; SL/TP –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (ATR) –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—ã–Ω–∫–∞ (pivot).

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `MasterForex_V_EA_v82308.mq5` –≤ `MQL5/Experts/` –∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ.
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä `MasterForex_Pivot_my_v82308.ex5` –ª–µ–∂–∏—Ç –≤ `MQL5/Indicators/`.
3. –ù–∞–∫–∏–Ω—å—Ç–µ —Å–æ–≤–µ—Ç–Ω–∏–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –±–∞–∑–æ–≤–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ M5). –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ—Ç–∞ –∏ —Ñ–ª–∞–≥–∏ –≤–∫–ª—é—á–µ–Ω–∏—è –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤ ‚Äî –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö EA.

–í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ: –ª–æ–≥–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∑–∞–¥–∞—ë—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º. –°–æ–≤–µ—Ç–Ω–∏–∫ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Å–ª–µ–¥—É–µ—Ç –∫–ª–∞—Å—Å–∞–º —Å–∏–≥–Ω–∞–ª–æ–≤ (Early/Normal/Strong).

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** pivot –∑–Ω–∞—á–µ–Ω–∏–π
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (—Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É). –ë–∞–∑–æ–≤–∞—è —Ç—Ä–æ–π–∫–∞ (H1/M15/M5) –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–æ—Ç–æ–≤–∞; –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫—ç—à —Ç—Ä–æ—Ç—Ç–ª–∏—Ç—Å—è.
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã** ZigZag
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –±–∞—Ä–æ–≤** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ–±—ä–µ–º–∞
 - **MF‚Äëpivot –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–≤—É—Ö —É—Å–ª–æ–≤–∏–π: —Ü–µ–Ω–∞ –ø—Ä–æ—à–ª–∞ `InpDeviation` –∏ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º—É–º `InpDepth` –±–∞—Ä–æ–≤ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –Ω–∞ —ç–∫—Å—Ç—Ä–µ–º—É–º.
  - **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –ø–∏–≤–æ—Ç–æ–≤**: –∫—ç—à H1/M15/M5/H4/D1 –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ –ª—é–±–æ–º –æ—Ç–∫—Ä—ã—Ç–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ, –ø–æ—ç—Ç–æ–º—É —É—Ä–æ–≤–Ω–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è—Ö –¢–§.
  - **Warm‚Äëup —Å–µ—Ä–∏–π**: –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–∞—á–∏–≤–∞–µ—Ç —Å–µ—Ä–∏–∏ (H1/M15/M5). –†–∞—Å—á—ë—Ç—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è; –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–∏—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –¥–æ—Ä–∏—Å–æ–≤–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞).
  - **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–∞**: –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è M5/M15 (–¥–æ 500 –±–∞—Ä–æ–≤) –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–Ω–¥–∞/RETEST –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º –±–∞—Ä–∞–º.
  - **–°–µ—Å—Å–∏–∏ –≤ GMT**: –≤—Ä–µ–º—è –±–µ—Ä—ë—Ç—Å—è `TimeTradeServer()` –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SessionGMTOffset`.

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–∏–≤–æ—Ç–æ–≤ (Pivot warm‚Äëup & cache)
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ/—Å–º–µ–Ω–µ –¢–§ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç ZigZag‚Äë—Ö–µ–Ω–¥–ª—ã (M5/M15/H1/H4/D1), —á—Ç–æ–±—ã —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É.
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∏–≤–æ—Ç–æ–≤ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Global Variables —Ç–µ—Ä–º–∏–Ω–∞–ª–∞: –∫–ª—é—á–∏ –≤–∏–¥–∞ `MFV:<SYMBOL>:<TF>:H|L|TS`.
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ UI —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—ç—à, –∞ –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω, –∫–æ–≥–¥–∞ ZigZag –≥–æ—Ç–æ–≤.
 - FastPivot –æ—Ç–¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ High/Low/time –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç PivotEngine, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö include. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ DualPivot –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ PivotEngine.
 - Fallback –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –µ—Å–ª–∏ lastSwing –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–±—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á—ë—Ç), –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ø–æ–ª–æ–∂–µ–Ω–∏—é —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–µ—Ä–µ–¥–∏–Ω—ã –º–µ–∂–¥—É H –∏ L. –ö–∞–∫ —Ç–æ–ª—å–∫–æ ZigZag –æ—Ç–¥–∞—ë—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –ø–∏–≤–æ—Ç—ã, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ç–æ—á–Ω—è–µ—Ç—Å—è.
 - –°—Ç—Ä–µ–ª–∫–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è Unicode-—Å–∏–º–≤–æ–ª–∞–º–∏ —á–µ—Ä–µ–∑ `CharToString(0x2191/0x2193)`; –¥–ª—è –ª–µ–π–±–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —à—Ä–∏—Ñ—Ç `Segoe UI Symbol`.
 - –û–Ω–ª–∞–π–Ω-—Ä–∞—Å—á—ë—Ç ZigZag –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ `BarsCalculated(h) ‚â• 10`; –¥–æ —ç—Ç–æ–≥–æ UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à/fast-fallback.
 - –¢–∞–π–º–µ—Ä: `M5/M15/H1 ‚Äî 1 —Å–µ–∫`, `H4 ‚Äî 2 —Å–µ–∫`, `D1 ‚Äî 5 —Å–µ–∫`.

–ù–æ–≤—ã–µ/–≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `PanelFontSize`, `PanelYOffset`
- `PanelUseArrows`, `PanelShowStrength` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)
- `ShowPivotH4`, `ShowPivotD1`
- `PivotColorH`, `PivotColorL`, `PivotLineStyle`, `PivotLineWidth`

–ò–º–µ–Ω–∞ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤:
- –õ–∏–Ω–∏–∏ –ø–∏–≤–æ—Ç–æ–≤: `MFV_Pivot_<TF>_<H|L>` (TF ‚àà {M5,M15,H1,H4,D1})
- –ü–∞–Ω–µ–ª—å: `MFV_Panel_Status_<idx>`

Troubleshooting:
- –õ–∏–Ω–∏–∏ –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å —Å—Ä–∞–∑—É: –æ—Ç–∫—Ä–æ–π—Ç–µ Ctrl+B –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `MFV_Pivot_*`. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ `ZigZag_Fixed` –∏ –ª–æ–≥–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.
- –ü–∏–≤–æ—Ç—ã –Ω—É–ª–∏: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ZigZag –±—É—Ñ–µ—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∫–∞–∫ `>0.0`, –∞ –Ω–µ `!= EMPTY_VALUE`.

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V:
- **–ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** —Å–æ–≥–ª–∞—Å–Ω–æ –º–µ—Ç–æ–¥–∏–∫–µ
- **–°–∏—Å—Ç–µ–º–∞ MF-pivot** —Å –∞–≤—Ç–æ—Ä—Å–∫–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
- **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã** –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- **–ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö** (M5, M15, H1)

## –ò–µ—Ä–∞—Ä—Ö–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

| –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ | –¶–≤–µ—Ç | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------------|------|------------|--------------|
| **–°–∏–ª—å–Ω—ã–π** | üü° –ñ–µ–ª—Ç—ã–π | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | ‚úÖ –õ—É—á—à–∏–π —Å–∏–≥–Ω–∞–ª |
| **–û–±—ã—á–Ω—ã–π** | üü¢ –ó–µ–ª–µ–Ω—ã–π/üî¥ –ö—Ä–∞—Å–Ω—ã–π | –í—ã—Å–æ–∫–∞—è | ‚úÖ –•–æ—Ä–æ—à–∏–π —Å–∏–≥–Ω–∞–ª |
| **–†–∞–Ω–Ω–∏–π** | üîµ –ì–æ–ª—É–±–æ–π | –°—Ä–µ–¥–Ω—è—è | ‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ |
| **–í—ã—Ö–æ–¥** | ‚ö´ –°–µ—Ä—ã–π –∫—Ä–µ—Å—Ç–∏–∫ | –í—ã—Å–æ–∫–∞—è | ‚ùå –ó–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é |
| **–†–∞–∑–≤–æ—Ä–æ—Ç** | üîµ –ê–∫–≤–∞ | –°—Ä–µ–¥–Ω—è—è | üîÑ –í–Ω–∏–º–∞–Ω–∏–µ |

## ATR –∏ –µ–¥–∏–Ω–∏—Ü—ã

- True Range (TR): `TR_t = max(High_t ‚àí Low_t, |High_t ‚àí Close_{t‚àí1}|, |Low_t ‚àí Close_{t‚àí1}|)`
- ATR –£–∞–π–ª–¥–µ—Ä–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ `N`: `ATR_t = (ATR_{t‚àí1}¬∑(N‚àí1) + TR_t)/N`
- –ü–∏–ø—Å—ã: –¥–ª—è 5‚Äë–∑–Ω–∞–∫–∞ EURUSD 1 pip = 0.00010; –ø—Ä–∏–º–µ—Ä: 0.00045 = 4.5 –ø–∏–ø—Å–∞.
- –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–±–æ—è (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ ATR), ¬´—à—É–º–æ–≤–æ–π¬ª –±—É—Ñ–µ—Ä `NOISE = max(Noise_M15√óATR(M15), Noise_H1√óATR(H1))`, —Å—Ç–æ–ø‚Äë–∑–∞–ø–∞—Å—ã/—Ç–æ–ª–µ—Ä–∞–Ω—Å—ã (`TrendTolAtrK`).

–ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —è—Ä–ª—ã–∫: `NOISE: 0.00200 (20.0 pips)`; –ø—Ä–∏ `ShowDetails=true` –Ω–∏–∂–µ –≤—ã–≤–æ–¥—è—Ç—Å—è —Ç–µ–∫—É—â–∏–µ `ATR(M15)`, `ATR(H1)` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏. –¢–æ—á–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `NoiseDecimals`.

## MF‚Äëpivot –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

- –í–∞—Ä–∏–∞–Ω—Ç A (—Ñ—Ä–∞–∫—Ç–∞–ª): `left/right` –±–∞—Ä–æ–≤ –≤–æ–∫—Ä—É–≥ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —ç–∫—Å—Ç—Ä–µ–º—É–º–∞.
- –í–∞—Ä–∏–∞–Ω—Ç B (ZigZag‚ÄëATR): —à–∞–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è = `ZigZagATR_K √ó ATR(H1)` –º–µ–∂–¥—É –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–º –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–º —Å–≤–∏–Ω–≥–æ–º.
- –î–ª—è H1 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ; –Ω–∞ –º–ª–∞–¥—à–∏—Ö –¢–§ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Ä–∞–Ω–Ω–∏–µ (–Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ) –º–µ—Ç–∫–∏, –Ω–æ –≤ —Å–∏–≥–Ω–∞–ª—ã –æ–Ω–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç, –ø–æ–∫–∞ –Ω–µ –±—É–¥—É—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã.

## –ü—Ä–æ–±–æ–π vs ¬´–ø—Ä–æ–∫–æ–ª¬ª

- ¬´–ü—Ä–æ–∫–æ–ª¬ª: –∫–∞—Å–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ –∫ –Ω–µ–º—É (–º–µ–Ω—å—à–µ ¬´—à—É–º–∞¬ª), —Ç–∞–∫–æ–π –±–∞—Ä –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–±–æ–µ–º.
- ¬´–ü—Ä–æ–±–æ–π¬ª: –∑–∞–∫—Ä—ã—Ç–∏–µ –∑–∞ —É—Ä–æ–≤–Ω–µ–º –Ω–∞ –≤–µ–ª–∏—á–∏–Ω—É ‚â• `Breakout_ATR_Mult √ó ATR(M15)` ‚Äî –ø—Ä–∏—á—ë–º –ø–æ `minCloseBars` –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏—è–º –≤ —Å—Ç–æ—Ä–æ–Ω—É –ø—Ä–æ–±–æ—è.
- –†–µ—Ç–µ—Å—Ç —É—Ä–æ–≤–Ω—è –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω: –∫–∞—Å–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è (–≤ –¥–æ–ø—É—Å–∫–µ –ø–æ ATR) –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ ¬´–æ—Ç¬ª —É—Ä–æ–≤–Ω—è –Ω–∞ M15 (–∏–ª–∏ M5, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ) —Å –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—â–µ–π —Ç–µ–Ω—å—é –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –æ–±—ä—ë–º–æ–º ‚â• `RetestVolMult`√ó—Å—Ä–µ–¥–Ω–∏–π.

## –¢–∞–±–ª–∏—Ü–∞ –∏–Ω–ø—É—Ç‚Äë–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–¥–µ—Ñ–æ–ª—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–µ—Ñ–æ–ª—Ç | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---|---:|---:|---|
| SessionGMTOffset | 2 | 1‚Äì4 | –°–º–µ—â–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∫ GMT; —Å `UseDST=true` +1 –ª–µ—Ç–æ–º (–ï–≤—Ä–æ–ø–∞) |
| UseDST | true | ‚Äî | –ê–≤—Ç–æ–ø–æ–ø—Ä–∞–≤–∫–∞ DST (–ï–≤—Ä–æ–ø–∞) |
| ATR_Period_M15 / ATR_Period_H1 | 14 / 14 | 10‚Äì21 | –ü–µ—Ä–∏–æ–¥—ã ATR –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤/—à—É–º–æ–≤ |
| Noise_Mult_M15 / Noise_Mult_H1 | 1.2 / 0.6 | 0.6‚Äì1.8 | –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è `NOISE = max(...)` |
| NoiseDecimals | 5 | 4‚Äì6 | –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ `NOISE` –≤ —Ü–µ–Ω–µ |
| InpDepth / InpDeviation | 12 / 5.0 | 8‚Äì24 / 3‚Äì15 | –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ZigZag |
| AtrDeviationK | 0.0 | 0.0‚Äì0.5 | ATR‚Äë–∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞ ZigZag |
| Depth_*, Dev_* | 12 / 5‚Äì30 | —Å–º. –¢–§ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ZigZag –ø–æ –¢–§ |
| TrendTolAtrK | 0.10 | 0.05‚Äì0.20 | –¢–æ–ª–µ—Ä–∞–Ω—Å —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Close —Å pivot |
| UseFractalConfirm, PivotLeftBars, PivotRightBars | true, 2, 2 | 2‚Äì3 | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ñ—Ä–∞–∫—Ç–∞–ª–æ–º |
| UseZigZagATR, ZigZagATR_K | true, 1.2 | 1.0‚Äì2.0 | –ê–ª—å—Ç. –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–≤–∏–Ω–≥–∞ –ø–æ ATR |
| Breakout_ATR_Mult, MinCloseBars | 1.0, 1 | 0.5‚Äì1.5, 1‚Äì2 | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ –ø—Ä–æ–±–æ—é —É—Ä–æ–≤–Ω—è |
| H1ClosesNeeded | 2 | 1‚Äì2 | –ó–∞–∫—Ä—ã—Ç–∏—è H1 –∑–∞ pivot –¥–ª—è Strong |
| RetestWindowM15/M5 | 12 / 36 | 8‚Äì24 / 24‚Äì48 | –û–∫–Ω–∞ –ø–æ–∏—Å–∫–∞ —Ä–µ—Ç–µ—Å—Ç–∞ |
| RetestTolATR_M15/M5 | 0.25 / 0.35 | 0.2‚Äì0.5 | –î–æ–ø—É—Å–∫ –∫–∞—Å–∞–Ω–∏—è —É—Ä–æ–≤–Ω—è (–≤ ATR) |
| WickRejectMin | 0.60 | 0.5‚Äì0.8 | –î–æ–ª—è —Ç–µ–Ω–∏ –æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –±–∞—Ä–∞ –Ω–∞ —Ä–µ—Ç–µ—Å—Ç–µ |
| UseRetestVolume, RetestVolMult | true, 1.20 | 1.1‚Äì1.5 | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä—ë–º–∞ –Ω–∞ —Ä–µ—Ç–µ—Å—Ç–µ |
| MinVolumeMultiplier | 1.2 | 1.1‚Äì1.6 | –ü–æ—Ä–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–±—ä—ë–º–∞ (2 –∏–∑ 3 –¢–§) |
| MinTrendStrength / MinEarlyTrendStrength | 2 / 1 | 1‚Äì3 | –ü–æ—Ä–æ–≥ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è –≤—Ö–æ–¥–æ–≤ |
| UseImpulseFilter, ImpulseMinRatio, PullbackMaxFib | true, 1.5, 0.618 | 1.2‚Äì2.0 / 0.38‚Äì0.78 | –§–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å‚Äë–æ—Ç–∫–∞—Ç |
| UseMarketPhaseFilter, FlatMedianThreshold | true, 1.20 | 1.1‚Äì1.4 | –î–∞—É–Ω–≥—Ä–µ–π–¥ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤–æ —Ñ–ª–µ—Ç–µ |
| UseClinchFilter, ClinchAtrK, ClinchLookbackH1, ClinchFlipsMin, ClinchRangeMaxATR | true, 0.5, 24, 3, 1.20 | ‚Äî | –§–∏–ª—å—Ç—Ä ¬´—Å—Ö–≤–∞—Ç–∫–∏¬ª H1 |
| BreakoutConfirm | StrongOnly | Off/StrongOnly/StrongAndNormal/All | –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è |
| ExitLogic | H1 | EntryTF/Nearest/SoftHard | –†–µ–∂–∏–º –≤—ã—Ö–æ–¥–∞ |

## –ú–∏–Ω–∏‚Äë—á–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- NOISE‚Äë–ª–µ–π–±–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–∏—Å–ª–æ –∏ –ø–∏–ø—Å—ã; –ø—Ä–∏ `ShowDetails=true` ‚Äî ATR(M15/H1) –∏ –º–Ω–æ–∂–∏—Ç–µ–ª–∏.
- –°–∏–≥–Ω–∞–ª—ã —Ä–∏—Å—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –±–∞—Ä–∞—Ö –∏ –±–µ–∑ –¥–æ—Ä–∏—Å–æ–≤–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.
- –ü—Ä–æ–±–æ–π M5‚Äëpivot —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è/—Ä–µ—Ç–µ—Å—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –∏ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ ¬´–ø—Ä–æ–∫–æ–ª–µ¬ª.
- –î–ª—è H1 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ MF‚Äëpivot –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ; —Ä–∞–Ω–Ω–∏–µ –º–µ—Ç–∫–∏ –Ω–∞ M15/M5 –Ω–µ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Å–∏–≥–Ω–∞–ª—ã –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
- –í –∫–ª–∏–Ω—á–µ (H1) –∫–ª–∞—Å—Å —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è.

## –°—Å—ã–ª–∫–∏

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç MasterForex-V](https://www.masterforex-v.org/)
- [GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/7SoKKoS7/indicator-MF-V-system-for-MT5)

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

**–í–µ—Ä—Å–∏—è:** 9  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** MetaTrader 5  
**–ê–≤—Ç–æ—Ä:** –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–º–æ–¥—É–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞)

MQL5/
  Indicators/
    MasterForex_V_legacy.mq5
    MFV_Modular/
      MFV_Modular.mq5
      README.md
      include/
        Config.mqh
        State.mqh
        MarketData.mqh
        PivotEngine.mqh
        TrendEngine.mqh
        Breakout.mqh
        Filters.mqh
        Signals.mqh
        Draw.mqh
        Panel.mqh
        GMLogger.mqh
Docs/
  MFV_Modular_SPEC.md
  MFV_Modular_SPEC.pdf
  MFV_Modular_flow.png
.vscode/
  settings.json
data/
  EURUSDM1.csv
  EURUSDM5.csv
  EURUSDM15.csv
  EURUSDM30.csv
  EURUSDH1.csv
  EURUSDH4.csv
  EURUSDDaily.csv
  EURUSDWeekly.csv
  EURUSDMonthly.csv
.cursorrules
.cursorignore
.gitignore
README.md


### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–í—Å–µ PDF/MD-—Å–ø–µ–∫–∏ –∏ —Å—Ö–µ–º—ã –ª–µ–∂–∞—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `/Docs/`.

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ CSV
–í—Å–µ —Ä—è–¥—ã —Ñ–æ—Ä–º–∞—Ç–∞ `EURUSD*.csv` –∏ –ø–æ–¥–æ–±–Ω—ã–µ —Ö—Ä–∞–Ω–∏–º –≤ `/data/`. –≠—Ç–∏ —Ñ–∞–π–ª—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è Cursor —Å–æ–≥–ª–∞—Å–Ω–æ `.cursorignore`.