# MasterForex-V MultiTF Indicator for MetaTrader 5

## –û–ø–∏—Å–∞–Ω–∏–µ

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä MasterForex-V MultiTF - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Å–∏—Å—Ç–µ–º—É MF-pivot –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- **–ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** (M5, M15, H1, H4, D1)
- **–°–∏—Å—Ç–µ–º–∞ MF-pivot** —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º ZigZag
- **–ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö** (M5, M15, H1)
- **–§–∏–ª—å—Ç—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π** (–õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫, –¢–æ–∫–∏–æ)
- **–°–∏—Å—Ç–µ–º–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞** (1-3 –±–∞–ª–ª–∞)
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

### –¢–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤:
- **üü° –°–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 3/3) - –∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üü¢ –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø–æ–∫—É–ø–∫–∏** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 1-2/3) - –∑–µ–ª–µ–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üî¥ –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–¥–∞–∂–∏** (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ 1-2/3) - –∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **üîµ –†–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã** (—á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ) - –≥–æ–ª—É–±—ã–µ —Å—Ç—Ä–µ–ª–∫–∏
- **‚ùå –°–∏–≥–Ω–∞–ª—ã –≤—ã—Ö–æ–¥–∞** (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ pivot) - —Å–µ—Ä—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏
- **üîÑ –°–∏–≥–Ω–∞–ª—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞** (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞) - –∞–∫–≤–∞ —Å—Ç—Ä–µ–ª–∫–∏

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –°–∏—Å—Ç–µ–º–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞:
- **3/3** - –æ—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ (–∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏)
- **2/3** - —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ (–∑–µ–ª–µ–Ω—ã–µ/–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏)
- **1/3** - —Å–ª–∞–±—ã–π —Ç—Ä–µ–Ω–¥ (—Ä–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã)

### –ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö:
- **M5** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 5-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **M15** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ 15-–º–∏–Ω—É—Ç–Ω–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **H1** - –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –º–∏–Ω–∏–º—É–º 2 –∏–∑ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ –¥–æ–ª–∂–Ω—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–±—ä–µ–º
- **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –±–∞—Ä—ã** –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞

### –§–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞:
- **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è** (–õ–æ–Ω–¥–æ–Ω, –ù—å—é-–ô–æ—Ä–∫, –¢–æ–∫–∏–æ)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
input bool   UseRussian = false;              // –ü–æ–¥–ø–∏—Å–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
input bool   ShowClassicPivot = true;         // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏ Pivot
input bool   ShowStatusInfo = true;           // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ
input bool   EnableVolumeFilter = true;       // –§–∏–ª—å—Ç—Ä –ø–æ –æ–±—ä–µ–º—É
input bool   EnableSessionFilter = true;      // –§–∏–ª—å—Ç—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ZigZag:
```mql5
input int    InpDepth = 12;                   // –ì–ª—É–±–∏–Ω–∞ ZigZag
input double InpDeviation = 5.0;              // –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤ –ø—É–Ω–∫—Ç–∞—Ö
input double AtrDeviationK = 0.0;             // –ö–æ—ç—Ñ. ATR –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ (0=–≤—ã–∫–ª)
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è ZigZag / MF‚Äëpivot
- **InpDepth**: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –±–∞—Ä–æ–≤ —É–¥–µ—Ä–∂–∞–Ω–∏—è —ç–∫—Å—Ç—Ä–µ–º—É–º–∞ –¥–æ —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ MF‚Äëpivot (–ø–∏–≤–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –ø—Ä–æ—à–ª–æ –Ω–µ –º–µ–Ω—å—à–µ `InpDepth` –±–∞—Ä–æ–≤ –∏ —Ü–µ–Ω–∞ –æ—Ç–æ—à–ª–∞ –Ω–µ –º–µ–Ω—å—à–µ `InpDeviation`).
- **InpDeviation**: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ü–µ–Ω–æ–≤–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–∫—Å—Ç—Ä–µ–º—É–º–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Å–º–µ–Ω—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
- **ATR‚Äë–∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞**: –µ—Å–ª–∏ `AtrDeviationK > 0`, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ = `max(InpDeviation * _Point, AtrDeviationK * ATR(tf,14))`. –ù–∞ –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–∏–≤–æ—Ç—ã —Ä–µ–∂–µ ¬´—Å—ã–ø—è—Ç—Å—è¬ª, –Ω–∞ –Ω–∏–∑–∫–æ–π ‚Äî –Ω–µ ¬´–∑–∞—Å—ã–ø–∞—é—Ç¬ª.
- **–ë–µ–∑ —Ä–µ–ø–µ–π–Ω—Ç–∞**: —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —ç–∫—Å—Ç—Ä–µ–º—É–º—ã; –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã ZigZag –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è. –¢–µ–∫—É—â–∏–π (–Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π) –±–∞—Ä –≤—Å–µ–≥–¥–∞ –∏—Å–∫–ª—é—á—ë–Ω. –ö—ç—à pivot –Ω–µ –∑–∞—Ç–∏—Ä–∞–µ—Ç—Å—è –Ω—É–ª—è–º–∏ ‚Äî –ø–æ–∫–∞ –Ω–æ–≤—ã–π —ç–∫—Å—Ç—Ä–µ–º—É–º –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–π.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Å—Å–∏–π:
```mql5
input int    SessionGMTOffset = 2;            // –°–º–µ—â–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ GMT (–ø—Ä–∏–º–µ—Ä: 2 –¥–ª—è GMT+2)
```
- –û–∫–Ω–∞ —Å–µ—Å—Å–∏–π –∑–∞–¥–∞–Ω—ã –≤ GMT: –õ–æ–Ω–¥–æ–Ω 8‚Äì16, –ù—å—é‚Äë–ô–æ—Ä–∫ 13‚Äì21, –¢–æ–∫–∏–æ 0‚Äì8.
- –í—Ä–µ–º—è –±–µ—Ä—ë—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –±—Ä–æ–∫–µ—Ä–∞ (`TimeTradeServer()`), –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ GMT –∫–∞–∫ `hourGMT = hourServer - SessionGMTOffset`.
- –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ–¥ DST –Ω–µ—Ç ‚Äî `SessionGMTOffset` –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—Ä—É—á–Ω—É—é (—á–∞—Å—Ç–æ 2 –∑–∏–º–æ–π, 3 –ª–µ—Ç–æ–º).
- –ü—Ä–∏–º–µ—Ä: Market Watch 22:40, –ª–æ–∫–∞–ª—å–Ω–æ –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã 21:40 (UTC+2) ‚Üí —Å–µ—Ä–≤–µ—Ä ~UTC+3 ‚Üí `SessionGMTOffset = 3`.

### –§–∏–ª—å—Ç—Ä—ã MasterForex-V:
```mql5
input double MinVolumeMultiplier = 1.2;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –æ–±—ä–µ–º–∞
input int    MinTrendStrength = 2;            // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ (1-3)
input int    MinEarlyTrendStrength = 1;       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è —Ä–∞–Ω–Ω–∏—Ö –≤—Ö–æ–¥–æ–≤ (1-3)
// –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –±—É–¥—É—â–µ–µ EA (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä):
input bool   UseRiskManagement = true;
input double MaxRiskPercent = 2.0;
```

### Clinch (—Å—Ö–≤–∞—Ç–∫–∞) –≤–æ–∫—Ä—É–≥ pivot H1
```mql5
input bool   UseClinchFilter   = true;        // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä ¬´—Å—Ö–≤–∞—Ç–∫–∏¬ª
input double ClinchAtrK        = 0.50;        // –ü–æ–ª—É—à–∏—Ä–∏–Ω–∞ –∑–æ–Ω—ã: k * ATR(H1)
input int    ClinchLookbackH1  = 24;          // –°–∫–æ–ª—å–∫–æ H1-–±–∞—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
input int    ClinchFlipsMin    = 3;           // –ú–∏–Ω–∏–º—É–º –ø–µ—Ä–µ–±—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ pivotH1
input double ClinchRangeMaxATR = 1.20;        // –ú–∞–∫—Å. –¥–∏–∞–ø–∞–∑–æ–Ω –∑–∞ Lookback –≤ ATR(H1)
input bool   ShowClinchZoneOnlyIfTouched = true; // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–æ–Ω—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∏–ª–∞ –≤ –Ω–µ—ë –∑–∞ Lookback
```
- –ó–æ–Ω–∞ clinch ‚Äî –ø–æ–ª–æ—Å–∞ ¬±`ClinchAtrK * ATR(H1)` –≤–æ–∫—Ä—É–≥ `pivotH1`.
- –ü—Ä–∏–∑–Ω–∞–∫ clinch: –ø–µ—Ä–µ–±—Ä–æ—Å—ã —Ü–µ–Ω—ã (–ø–æ Close H1) —á–µ—Ä–µ–∑ `pivotH1` ‚â• `ClinchFlipsMin` –∏ –¥–∏–∞–ø–∞–∑–æ–Ω `max(high)‚àímin(low)` –∑–∞ `ClinchLookbackH1` ‚â§ `ClinchRangeMaxATR * ATR(H1)`.
- –í clinch –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –∫–ª–∞—Å—Å —Å–∏–≥–Ω–∞–ª–æ–≤: —Å–∏–ª—å–Ω—ã–µ ‚Üí –æ–±—ã—á–Ω—ã–µ, –æ–±—ã—á–Ω—ã–µ ‚Üí —Ä–∞–Ω–Ω–∏–µ, —Ä–∞–Ω–Ω–∏–µ ‚Üí –±–ª–æ–∫.
- –í –ø–∞–Ω–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞: `Clinch: ‚úì/‚úó, flips=X, range=Y ATR, zone=¬±K ATR`.
- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–æ–Ω—ã: –µ—Å–ª–∏ `ShowClinchZoneOnlyIfTouched = true`, –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∏—Å—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –∑–∞—Ö–æ–¥–∏–ª–∞ –≤ –∑–æ–Ω—É –∑–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã–π –ø–µ—Ä–∏–æ–¥.
> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ Risk Management: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `UseRiskManagement` –∏ `MaxRiskPercent` –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Å–æ–≤–µ—Ç–Ω–∏–∫–∞ (EA). –í —Ç–µ–∫—É—â–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ –æ–Ω–∏ –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞—Å—á—ë—Ç —Å–∏–≥–Ω–∞–ª–æ–≤.

### –°—Ç—Ä–æ–≥–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ ¬´no repaint¬ª –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –±–∞—Ä–∞—Ö; –≤ –ª–æ–≥–∏–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ü–µ–Ω–∞ `Close[1]` —Ç–µ–∫—É—â–µ–≥–æ –¢–§.
- –¢—Ä–µ–Ω–¥‚Äë—Ç–æ–ª–µ—Ä–∞–Ω—Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π: `tol = max(2*_Point, 0.1*ATR(H1))` (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ ATR‚Äë–∞–¥–∞–ø—Ç–∞—Ü–∏—è), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—Ä–µ–±–µ–∑–≥–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö.
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è H1: —Ä–µ—Ç–µ—Å—Ç –∏—â–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ü–û–°–õ–ï –∑–∞–∫—Ä—ã—Ç–∏—è —á–∞—Å–∞ (`fromTime = iTime(H1,1) + PeriodSeconds(H1)`), –∞ –Ω–µ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ.
- Clinch —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º H1‚Äë–±–∞—Ä–∞–º; –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∑–æ–Ω–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è —Å —Ç–µ–º –∂–µ ATR, —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è–ª—Å—è –ø—Ä–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–∑–∞–º–æ—Ä–æ–∑–∫–∞ ATR).
- –í—ã—Ö–æ–¥—ã (–≤–∫–ª—é—á–∞—è Soft/Hard) —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç—É—é —Ü–µ–Ω—É –±–∞—Ä–∞; –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ `Close[0]`.
- –í —Ä–µ–∂–∏–º–µ `Exit_Nearest` ¬´–±–ª–∏–∂–∞–π—à–∏–π¬ª pivot –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ü–µ–Ω—ã –Ω–∞ –±–∞—Ä–µ –≤—Ö–æ–¥–∞, –∞ –Ω–µ —Ç–µ–∫—É—â–µ–π.

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–±–æ—è Pivot (H1)
```mql5
enum ConfirmMode { Confirm_Off, Confirm_StrongOnly, Confirm_StrongAndNormal, Confirm_All };
input ConfirmMode BreakoutConfirm = Confirm_StrongOnly; // –†–µ–∂–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

input int    H1ClosesNeeded       = 2;     // —Å–∫–æ–ª—å–∫–æ H1‚Äë–∑–∞–∫—Ä—ã—Ç–∏–π –∑–∞ pivot
input int    RetestWindowM15      = 12;    // –æ–∫–Ω–æ —Ä–µ—Ç–µ—Å—Ç–∞ –≤ M15‚Äë–±–∞—Ä–∞—Ö (–¥–æ 3 —á)
input double RetestTolATR_M15     = 0.25;  // –¥–æ–ø—É—Å–∫ –∫–∞—Å–∞–Ω–∏—è: ¬±0.25*ATR(M15)
input double WickRejectMin        = 0.60;  // –¥–æ–ª—è —Ç–µ–Ω–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –±–∞—Ä–∞ (–æ—Ç—Å–∫–æ–∫)
input bool   UseRetestVolume      = true;  // —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±—ä—ë–º –Ω–∞ —Ä–µ—Ç–µ—Å—Ç–µ
input double RetestVolMult        = 1.20;  // –æ–±—ä—ë–º —Ä–µ—Ç–µ—Å—Ç–∞ > 1.2√ó —Å—Ä–µ–¥–Ω–µ–≥–æ
input bool   RetestAllowM5        = true;  // —Ä–µ—Ç–µ—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –Ω–∞ M5
input int    RetestWindowM5       = 36;    // –æ–∫–Ω–æ —Ä–µ—Ç–µ—Å—Ç–∞ –≤ M5‚Äë–±–∞—Ä–∞—Ö (~3 —á)
input double RetestTolATR_M5      = 0.35;  // –¥–æ–ø—É—Å–∫ –∫–∞—Å–∞–Ω–∏—è –¥–ª—è M5
```
- Strong –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç—Ä–µ–±—É–µ—Ç: 2 –∑–∞–∫—Ä—ã—Ç–∏—è H1 –∑–∞ pivot –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤—Ö–æ–¥–∞ –ò —Ä–µ—Ç–µ—Å—Ç —É—Ä–æ–≤–Ω—è –Ω–∞ M15 (–ø–æ –∂–µ–ª–∞–Ω–∏—é —Ç–∞–∫–∂–µ M5) —Å –æ—Ç—Å–∫–æ–∫–æ–º (—Ç–µ–Ω—å) –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –æ–±—ä—ë–º–æ–º.
- Normal: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 1 –∑–∞–∫—Ä—ã—Ç–∏—è H1 –∑–∞ pivot; –µ—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–µ—Ç ‚Äî —Å–∏–≥–Ω–∞–ª –±—É–¥–µ—Ç –ø–æ–Ω–∏–∂–µ–Ω –¥–æ Early.
- Early: –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π.
- –†–µ–∂–∏–º –∑–∞–¥–∞—ë—Ç—Å—è `BreakoutConfirm`: –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ —Ç–æ–ª—å–∫–æ –∫ Strong (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), –∫ Strong+Normal, –∫–æ –≤—Å–µ–º –∏–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å.
- –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π ¬´—Å—Ö–≤–∞—Ç–∫–µ¬ª (clinch) –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –∫–ª–∞—Å—Å —É–∂–µ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–æ–º clinch.

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

- **–¢—Ä–µ–Ω–¥ H1: ‚Üë M15: ‚Üë M5: ‚Üë** - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤ –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
- **–ü–∏–≤–æ—Ç M5: 1.07053** - —É—Ä–æ–≤–Ω–∏ pivot –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
- **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞: 3/3** - –æ—Ü–µ–Ω–∫–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ (1-3 –±–∞–ª–ª–∞)
- **–û–±—ä–µ–º M5:‚úì M15:‚úì H1:‚úì (3/3)** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –Ω–∞ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
- **–°–µ—Å—Å–∏—è: ‚úì** - –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö):
- **Clinch:** `‚úì/‚úó, flips=X, range=Y ATR, zone=¬±K ATR` ‚Äî —Å—Ç–∞—Ç—É—Å ¬´—Å—Ö–≤–∞—Ç–∫–∏¬ª –≤–æ–∫—Ä—É–≥ `pivotH1` (—Ä–∞—Å—á—ë—Ç –ø–æ –∑–∞–∫—Ä—ã—Ç—ã–º –±–∞—Ä–∞–º H1).
- **–§–∞–∑–∞:** `Trend/Flat` ‚Äî –¥–µ—Ç–µ–∫—Ç–æ—Ä —Ä—ã–Ω–æ—á–Ω–æ–π —Ñ–∞–∑—ã –ø–æ –∫–∞—á–µ–ª—è–º –Ω–∞ M15; –≤–æ —Ñ–ª–µ—Ç–µ —Å–∏–≥–Ω–∞–ª—ã –¥–∞—É–Ω–≥—Ä–µ–π–¥—è—Ç—Å—è –¥–æ Early.
- **Consensus:** `2/3 ‚úì | EMA:‚Üë|‚Üì|‚Äì | RSI: ‚úì|‚úó` ‚Äî –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ MF‚Äë—è–¥—Ä–æ/EMA/RSI. –†–µ–∂–∏–º —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `Consensus` (PanelOnly/Gate*/BlockAll).
- **–°–∏–≥–Ω–∞–ª:** `Strong BUY/Strong SELL/BUY/SELL/Early BUY/Early SELL/Early EXIT/HARD EXIT/Reversal` ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏–≥–Ω–∞–ª–∞.

## –õ–æ–≥–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### –°–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–∂–µ–ª—Ç—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚úÖ **–í—Å–µ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç** (H1, M15, M5)
- ‚úÖ **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ = 3/3** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**
 - ‚úÖ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ `BreakoutConfirm`) **–ü—Ä–æ–±–æ–π —Å –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º**: `H1ClosesNeeded` –∑–∞–∫—Ä—ã—Ç–∏–π –∑–∞ pivot + **—Ä–µ—Ç–µ—Å—Ç** pivot –Ω–∞ M15/M5 —Å –æ—Ç—Å–∫–æ–∫–æ–º (—Ç–µ–Ω—å—é) –∏, –ø—Ä–∏ `UseRetestVolume=true`, –æ–±—ä—ë–º–æ–º ‚â• `RetestVolMult`√ó—Å—Ä–µ–¥–Ω–µ–≥–æ.

### –û–±—ã—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã (–∑–µ–ª–µ–Ω—ã–µ/–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚úÖ **–í—Å–µ 3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç** (H1, M15, M5)
- ‚ö†Ô∏è **–°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ = 1-2/3** (—Å—Ä–µ–¥–Ω—è—è)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**
 - ‚ö†Ô∏è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ Normal) –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–æ–±–æ—è –ø–æ H1 ‚Äî —Å–∏–≥–Ω–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ Early.

### –†–∞–Ω–Ω–∏–µ —Å–∏–≥–Ω–∞–ª—ã (–≥–æ–ª—É–±—ã–µ —Å—Ç—Ä–µ–ª–∫–∏):
- ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ** (H1 –∏ M5, –Ω–æ –ù–ï M15)
- ‚ö†Ô∏è **–°–ª–∞–±–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞** ‚Äî –ø–æ—Ä–æ–≥ –∑–∞–¥–∞—ë—Ç—Å—è `MinEarlyTrendStrength` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1/3)
- ‚úÖ **–û–±—ä–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (–º–∏–Ω–∏–º—É–º 2/3 —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤)
- ‚úÖ **–í–∞–ª–∏–¥–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–µ—Å—Å–∏—è**

### –ò–º–ø—É–ª—å—Å‚Äë–æ—Ç–∫–∞—Ç (MF A‚ÄëB‚ÄëC) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è/–ø–æ–Ω–∏–∂–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞
- –ù–∞ M15, –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–¥–∞ H1, —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ A‚ÄëB‚ÄëC:
  - –ò–º–ø—É–ª—å—Å ¬´–∑–¥–æ—Ä–æ–≤—ã–π¬ª, –µ—Å–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ `|B‚àíA| / |C‚àíB| ‚â• ImpulseMinRatio` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.5).
  - –ì–ª—É–±–∏–Ω–∞ –æ—Ç–∫–∞—Ç–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –¥–æ–ª—è `|C‚àíB| / |B‚àíA|` –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å `PullbackMaxFib` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.618).
- –ü—Ä–∞–≤–∏–ª–∞ –∞–ø/–¥–∞—É–Ω‚Äë–≥—Ä–µ–π–¥–∞:
  - –ï—Å–ª–∏ –∏–º–ø—É–ª—å—Å ¬´–∑–¥–æ—Ä–æ–≤—ã–π¬ª ‚Äî —Ä–∞–Ω–Ω–∏–π —Å–∏–≥–Ω–∞–ª (Early) –∞–ø–≥—Ä–µ–π–¥–∏—Ç—Å—è –¥–æ –æ–±—ã—á–Ω–æ–≥–æ (Normal).
  - –ï—Å–ª–∏ –æ—Ç–∫–∞—Ç —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–∏–π ‚Äî –æ–±—ã—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª (Normal) –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ —Ä–∞–Ω–Ω–µ–≥–æ (Early) –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é, —Å–µ–π—á–∞—Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ).

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
input bool   UseImpulseFilter     = true;   // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å–∞/–æ—Ç–∫–∞—Ç–∞
input double ImpulseMinRatio      = 1.5;    // |B‚àíA| / |C‚àíB| –º–∏–Ω–∏–º—É–º
input double PullbackMaxFib       = 0.618;  // –º–∞–∫—Å. –≥–ª—É–±–∏–Ω–∞ –æ—Ç–∫–∞—Ç–∞ (–¥–æ–ª—è –∏–º–ø—É–ª—å—Å–∞)
input int    ImpulseBackWindowM15 = 48;     // –ø–æ–∏—Å–∫ A –ø–µ—Ä–µ–¥ B (M15‚Äë–±–∞—Ä–æ–≤)
input int    PullbackWindowM15    = 12;     // –ø–æ–∏—Å–∫ C –ø–æ—Å–ª–µ B (M15‚Äë–±–∞—Ä–æ–≤)
```

### –§–∏–ª—å—Ç—Ä ¬´—Ä—ã–Ω–æ—á–Ω–æ–π —Ñ–∞–∑—ã¬ª (Flat/Trend)
–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–∞—É–Ω–≥—Ä–µ–π–¥–∏—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–æ Early –≤–æ —Ñ–ª–µ—Ç–µ, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–Ω–æ–Ω—É MF‚ÄëV (—Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç—Ä–µ–Ω–¥–µ).
- –î–µ—Ç–µ–∫—Ü–∏—è: –ø–æ —Ç—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–º –∫–∞—á–µ–ª—è–º –Ω–∞ M15. –í—ã—á–∏—Å–ª—è–µ–º –¥–ª–∏–Ω—ã —Ç—Ä—ë—Ö –∫–æ–ª–µ–Ω, —Å—á–∏—Ç–∞–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ –±–µ—Ä—ë–º –º–µ–¥–∏–∞–Ω—É.
- –ï—Å–ª–∏ –º–µ–¥–∏–∞–Ω–∞ < `FlatMedianThreshold` (–¥–µ—Ñ–æ–ª—Ç 1.20) ‚Äî —Ñ–ª–µ—Ç: —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–∞–Ω–Ω–∏–µ –≤—Ö–æ–¥—ã. –ü–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É `Phase: Flat/Trend`.
```mql5
input bool   UseMarketPhaseFilter = true;   // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —Ñ–ª–µ—Ç/—Ç—Ä–µ–Ω–¥
input double FlatMedianThreshold  = 1.20;   // –ü–æ—Ä–æ–≥ –º–µ–¥–∏–∞–Ω—ã —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π –∫–∞—á–µ–ª–µ–π (–Ω–∏–∂–µ ‚Äî —Ñ–ª–µ—Ç)
```

### –°–∏–≥–Ω–∞–ª—ã –≤—ã—Ö–æ–¥–∞ (—Å–µ—Ä—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏):
- ‚ùå **–ñ—ë—Å—Ç–∫–∏–π –≤—ã—Ö–æ–¥ (hard):** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ pivot H1 —Ü–µ–Ω–æ–π –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
- ‚ÑπÔ∏è –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç–∫—É —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (–∞–∫–≤–∞), –∫–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ –Ω–∞ H1 –∏ M15.

### –†–µ–∂–∏–º—ã –≤—ã—Ö–æ–¥–∞ (ExitMode)
```mql5
enum ExitMode { Exit_H1, Exit_EntryTF, Exit_Nearest, Exit_SoftHard };
input ExitMode ExitLogic = Exit_H1;           // –¥–µ—Ñ–æ–ª—Ç: H1
input double   ExitNearestAtrK = 0.25;        // —Ñ–∏–ª—å—Ç—Ä –±–ª–∏–∑–æ—Å—Ç–∏ (–≤ ATR M15) –¥–ª—è Nearest
```
- **Exit_H1 (–¥–µ—Ñ–æ–ª—Ç)**: –≤—ã—Ö–æ–¥ –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é `pivotH1`.
- **Exit_EntryTF**: –≤—ã—Ö–æ–¥ –ø–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—é `pivotM5` (–¢–§ –≤—Ö–æ–¥–∞).
- **Exit_Nearest**: –≤—ã—Ö–æ–¥ –ø–æ –±–ª–∏–∂–∞–π—à–µ–º—É –∏–∑ `pivotM5/M15/H1` —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ `ExitNearestAtrK * ATR(M15)`; —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ (–∑–∞–∫—Ä—ã—Ç–æ–π).
- **Exit_SoftHard**: soft‚Äëexit ‚Äî –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ `pivotM15` (—Å–∏–≥–Ω–∞–ª –≤ `EarlyExitBuffer`) –±–µ–∑ —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è; hard‚Äëexit ‚Äî –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ `pivotH1` —Å–æ —Å–±—Ä–æ—Å–æ–º.

### –ö–æ–Ω—Å–µ–Ω—Å—É—Å‚Äë—Ñ–∏–ª—å—Ç—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ò–¥–µ—è: —É –≤–∞—Å —Ç—Ä–∏ ¬´–≥–æ–ª–æ—Å–∞¬ª ‚Äî MF‚Äë—è–¥—Ä–æ, EMA‚Äë–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ M15, RSI(14) M15. –ö–æ–Ω—Å–µ–Ω—Å—É—Å ¬´2 –∏–∑ 3¬ª –º–æ–∂–µ—Ç:
- —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –Ω–∞ –ø–∞–Ω–µ–ª–∏,
- –¥–∞—É–Ω–≥—Ä–µ–π–¥–∏—Ç—å Strong (–∏–ª–∏ Strong/Normal),
- –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—ã –±–µ–∑ 2/3.

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:
```mql5
enum ConsensusMode { Cons_Off, Cons_PanelOnly, Cons_GateStrong, Cons_GateStrongNormal, Cons_BlockAll };
input ConsensusMode  Consensus   = Cons_PanelOnly;
input int   EmaFast = 50, EmaSlow = 200;
input double EmaSlopeMin = 0.0;   // –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–∫–ª–æ–Ω EMA50
input int   RsiPeriod = 14;
input int   RsiOB = 70, RsiOS = 30;
input int   RsiHyst = 5;          // –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å
```
- EMA‚Äë–≥–æ–ª–æ—Å: `EMA50 > EMA200` (–∏ |–Ω–∞–∫–ª–æ–Ω| EMA50 ‚â• `EmaSlopeMin * ATR(M15)`; –ø—Ä–∏ `EmaSlopeMin=0` –Ω–∞–∫–ª–æ–Ω –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è) ‚Üí buy; `<` ‚Üí sell; –∏–Ω–∞—á–µ ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ.
- RSI‚Äë–≥–æ–ª–æ—Å: buy —Ä–∞–∑—Ä–µ—à—ë–Ω, –µ—Å–ª–∏ `RSI ‚â§ (OB-Hyst)`; sell ‚Äî –µ—Å–ª–∏ `RSI ‚â• (OS+Hyst)`.
- –†–µ–∂–∏–º—ã:
  - Off ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç.
  - PanelOnly ‚Äî —Ä–∏—Å—É–µ—Ç —Å—Ç—Ä–æ–∫—É `Consensus: 2/3 ‚úì | EMA:‚Üë | RSI:‚úì`.
  - GateStrong ‚Äî –±–µ–∑ 2/3 Strong ‚Üí Normal.
  - GateStrongNormal ‚Äî –±–µ–∑ 2/3: Strong ‚Üí Normal, Normal ‚Üí Early.
  - BlockAll ‚Äî –±–µ–∑ 2/3 –≤—Ö–æ–¥—ã –Ω–µ —Ä–∏—Å—É—é—Ç—Å—è.

–ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: Clinch –ø–æ–Ω–∏–∂–∞–µ—Ç –∫–ª–∞—Å—Å ‚Üí Consensus (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω) –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç. Early –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å ¬´—Ä–∞–Ω–Ω–∏–π¬ª —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤.

–ü–∞–Ω–µ–ª—å:
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏ `Phase: Flat/Trend` –∏ `Consensus: 2/3 ‚úì | EMA:‚Üë | RSI:‚úì`.
### –°–∏–≥–Ω–∞–ª—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (–∞–∫–≤–∞ —Å—Ç—Ä–µ–ª–∫–∏):
- üîÑ **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞** –Ω–∞ H1 –∏ M15
- üîÑ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç** —Ç—Ä–µ–Ω–¥–∞

#### –û —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã—Ö–æ–¥–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–ª–µ–¥—É–µ—Ç —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ–π –ª–æ–≥–∏–∫–µ MF‚ÄëV: –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—ë—Ç H1, –≤—Ö–æ–¥—ã ‚Äî –Ω–∞ M5/M15, –≤—ã—Ö–æ–¥ ‚Äî –ø–æ pivotH1. –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —à—É–º –∏ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Ö–≤–∞—Ç—ã.
- –ü—Ä–∞–∫—Ç–∏—á–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã (–º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –æ–ø—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º):
  - ¬´–ü–æ –¢–§ –≤—Ö–æ–¥–∞¬ª (—á–∞—â–µ M5): –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ç–æ–ø –∏ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏.
  - ¬´–ë–ª–∏–∂–∞–π—à–∏–π pivot (M5/M15/H1)¬ª —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ ATR, —á—Ç–æ–±—ã –Ω–µ –±—Ä–∞—Ç—å —Å–ª–∏—à–∫–æ–º —Ç–µ—Å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏.
  - ¬´–î–≤–∞ —É—Ä–æ–≤–Ω—è: –º—è–≥–∫–∏–π/–∂—ë—Å—Ç–∫–∏–π¬ª: soft ‚Äî –ø–æ M15 (—á–∞—Å—Ç–∏—á–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è/BE), hard ‚Äî –ø–æ H1 (–ø–æ–ª–Ω—ã–π –≤—ã—Ö–æ–¥).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `MasterForex_Pivot_my_v82308.mq5` –≤ –ø–∞–ø–∫—É `MQL5/Indicators/`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ MetaTrader 5
3. –ù–∞–π–¥–∏—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ —Å–ø–∏—Å–∫–µ –∫–∞–∫ "MasterForex-V MultiTF v8.2308"
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Å–≤–æ–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- **–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** pivot –∑–Ω–∞—á–µ–Ω–∏–π
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (—Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É)
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã** ZigZag
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –±–∞—Ä–æ–≤** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ–±—ä–µ–º–∞
 - **MF‚Äëpivot –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–≤—É—Ö —É—Å–ª–æ–≤–∏–π: —Ü–µ–Ω–∞ –ø—Ä–æ—à–ª–∞ `InpDeviation` –∏ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º—É–º `InpDepth` –±–∞—Ä–æ–≤ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –Ω–∞ —ç–∫—Å—Ç—Ä–µ–º—É–º.
 - **–°–µ—Å—Å–∏–∏ –≤ GMT**: –≤—Ä–µ–º—è –±–µ—Ä—ë—Ç—Å—è `TimeTradeServer()` –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SessionGMTOffset`.

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V:
- **–ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** —Å–æ–≥–ª–∞—Å–Ω–æ –º–µ—Ç–æ–¥–∏–∫–µ
- **–°–∏—Å—Ç–µ–º–∞ MF-pivot** —Å –∞–≤—Ç–æ—Ä—Å–∫–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
- **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã** –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- **–ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö** (M5, M15, H1)

## –ò–µ—Ä–∞—Ä—Ö–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

| –¢–∏–ø —Å–∏–≥–Ω–∞–ª–∞ | –¶–≤–µ—Ç | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|-------------|------|------------|--------------|
| **–°–∏–ª—å–Ω—ã–π** | üü° –ñ–µ–ª—Ç—ã–π | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è | ‚úÖ –õ—É—á—à–∏–π —Å–∏–≥–Ω–∞–ª |
| **–û–±—ã—á–Ω—ã–π** | üü¢ –ó–µ–ª–µ–Ω—ã–π/üî¥ –ö—Ä–∞—Å–Ω—ã–π | –í—ã—Å–æ–∫–∞—è | ‚úÖ –•–æ—Ä–æ—à–∏–π —Å–∏–≥–Ω–∞–ª |
| **–†–∞–Ω–Ω–∏–π** | üîµ –ì–æ–ª—É–±–æ–π | –°—Ä–µ–¥–Ω—è—è | ‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ |
| **–í—ã—Ö–æ–¥** | ‚ö´ –°–µ—Ä—ã–π –∫—Ä–µ—Å—Ç–∏–∫ | –í—ã—Å–æ–∫–∞—è | ‚ùå –ó–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é |
| **–†–∞–∑–≤–æ—Ä–æ—Ç** | üîµ –ê–∫–≤–∞ | –°—Ä–µ–¥–Ω—è—è | üîÑ –í–Ω–∏–º–∞–Ω–∏–µ |

## –°—Å—ã–ª–∫–∏

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç MasterForex-V](https://www.masterforex-v.org/)
- [GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/7SoKKoS7/indicator-MF-V-system-for-MT5)

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

**–í–µ—Ä—Å–∏—è:** 8.230  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** MetaTrader 5  
**–ê–≤—Ç–æ—Ä:** –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ MasterForex-V