# MasterForex-V MultiTF Indicator for MetaTrader 5.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![MetaTrader 5](https://img.shields.io/badge/platform-MetaTrader5-blue.svg)](https://www.metatrader5.com/)
[![Status: In Development](https://img.shields.io/badge/status-active-brightgreen.svg)]()

---

## Описание

**MasterForex-V MultiTF** — это мульти-таймфреймовый индикатор для MetaTrader 5, полностью реализующий методику MasterForex-V:

- **Автоматический расчет и отображение уровней MF-pivot** (значимых экстремумов) для M5, M15, H1, H4, D1
- **Генерация стрелочных сигналов Buy/Sell** по классическим правилам MF-V
- **Панель статуса трендов** (Up/Down/Flat) по трем основным ТФ в левом верхнем углу
- **Метки выхода и разворота тренда** (крестики, специальные стрелки)
- **Горизонтальные линии всех pivot-уровней** на графике

> ⚡️ _Работает "из коробки" на любом графике (рекомендуется запускать на M5)_

---

## Алгоритм и логика

### Основные этапы:

1. **Экстремумы ZigZag**  
   На каждом из таймфреймов (H1, M15, M5, H4, D1) через ZigZag ищутся ключевые максимумы/минимумы.

2. **Расчет MF-pivot**  
   MF-pivot — это последний подтвержденный экстремум на каждом ТФ, который "держит" импульс.

3. **Определение тренда**  
   - Up, если цена выше pivot, Down — ниже, Flat — рядом или волатильность низкая.

4. **Визуализация**  
   - Горизонтальные линии pivot-уровней  
   - Стрелки Buy/Sell (подтвержденные и ранние)  
   - Крестики выхода  
   - Спец-значки разворота  
   - Панель статуса трендов

5. **Генерация сигналов**  
   - **Яркий сигнал**: все три ТФ в унисон (стрелка насыщенного цвета)
   - **Ранний сигнал**: совпадает H1 и M5, но не M15 (стрелка бледная)
   - **Сигнал выхода**: пробитие pivot против позиции или смена тренда на M15
   - **Разворот тренда**: подтвержденная смена H1 и M15

---

## Структура проекта

- `MasterForex_Pivot_my_v3.mq5` — основной файл индикатора (исходный код)
- `книга 3.pdf` — третья книга MasterForex-V (методика, теория, алгоритм)
- `README.md` — этот файл
- **История цен EUR/USD (для тестов):**
    - `EURUSDDaily.csv`
    - `EURUSDH1.csv`
    - `EURUSDH4.csv`
    - `EURUSDM1.csv`
    - `EURUSDM5.csv`
    - `EURUSDM15.csv`
    - `EURUSDM30.csv`
    - `EURUSDMonthly.csv`
    - `EURUSDWeekly.csv`
- `пример графика как сейчас работает-.png` — актуальный скриншот индикатора в MetaTrader

---

### История цен для тестирования

В репозитории представлены файлы с историческими котировками EUR/USD для всех основных таймфреймов.  
**Рекомендуется:** тестировать работу индикатора, оптимизацию, доработки и сравнение сигналов именно на этих исторических данных. Это позволяет объективно проверять эффективность всех стратегий MF-V на практике.

---

## Скриншоты

| Индикатор на графике (пример) |
|:---:|
| ![пример графика](./пример%20графика%20как%20сейчас%20работает-.png) |

---

## Установка

1. Скопируйте файл индикатора в папку `MQL5/Indicators/`
2. Откройте MetaEditor, скомпилируйте индикатор
3. Добавьте на нужный график (лучше всего на M5)
4. Настройте внешний вид через параметры, если требуется

---

## Чек-лист реализации

- [x] ZigZag-экстремумы для M5, M15, H1, H4, D1
- [x] Авторасчет MF-pivot на каждом ТФ
- [x] Определение тренда Up/Down/Flat
- [x] Горизонтальные линии pivot-уровней
- [x] Панель трендов (в левом верхнем углу)
- [x] Стрелки Buy/Sell (строго по MF-V)
- [x] Метки выхода и разворота
- [ ] ~~Фильтры сигналов по объему/осцилляторам/паттернам~~ (планируется)
- [ ] ~~Звуковые и push-уведомления~~ (планируется)
- [ ] ~~Автоматизация стоп-лосса~~ (планируется)
- [ ] ~~Удаление старых объектов~~ (рекомендация)

---

## Идеи для доработки и оптимизации

- **Фильтрация флэта:** добавить дополнительные индикаторы (например, ATR, RSI, объем) для отбора сигналов во флэте
- **Автоматизация работы со стоп-лоссом:** авторасчет SL/TP от MF-pivot
- **Уведомления:** добавить Alert/Push/Email на ключевые сигналы
- **Кастомизация:** дать выбор цвета/стиля/размера для всех линий и стрелок через параметры
- **История объектов:** умное удаление/очистка старых стрелок/меток для ускорения работы

---

## Для ИИ/разработчиков

- Все сигналы строго по оригинальному алгоритму MasterForex-V ([см. PDF](./Алгоритм%20индикатора%20MasterForex‑V%20для%20MetaTrader%205%20(1).pdf))
- Используется только подтвержденный pivot (не на текущем формирующемся баре!)
- Нет фильтрации по объемам/паттернам — рекомендовано доработать для повышения надежности на флэте
- Панель трендов легко расширяется для добавления новых статусов или анализа других ТФ
- Если видите возможность ускорения/оптимизации — пожалуйста, сделайте Pull Request!

---

## Источники и ссылки

- [MasterForex-V: Книга 1 (онлайн)](https://www.masterforex-v.org/mf_books/book1.html)
- [MasterForex-V: Книга 2 (онлайн)](https://www.masterforex-v.org/mf_books/book2.html)
- [MasterForex-V: Книга 3 (PDF на GitHub)](https://github.com/7SoKKoS7/indicator-MF-V-system-for-MT5/blob/main/%D0%BA%D0%BD%D0%B8%D0%B3%D0%B0%203.pdf)
- [MQL5 ZigZag Docs](https://www.mql5.com/en/docs/indicators/zigzag)
- [MQL5 Multi-TF Articles](https://www.mql5.com/en/articles/2837)

---

## License

MIT License

---

> _Вопросы, предложения и доработки приветствуются!_
